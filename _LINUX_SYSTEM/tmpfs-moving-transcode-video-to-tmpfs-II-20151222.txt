filename: tmpfs_moving-transcode-video-to-tmpfs_II_20151222.txt

https://www.reddit.com/r/PleX/comments/3461op/use_ram_as_your_transcode_directory_huge_speed/

Use RAM as your transcode directory - HUGE Speed boost! self.PleX
Submitted pred 7 mesec * by [deleted]
Hey guys I saw this buried in a thread on this sub I thought I would give it more light. Imdisk let's you create VHD on your RAM. So for me 16gb of RAM doesn't help pled much since its mostly processor intensive. So I made an 8gb VHD and use that as my pled transcoding directory. I'm running old-school RAM and I can StI'll support theorhetocal speeds up to 6gb/s. That beats most any other solution I can think of and even remote streams are doing much better.
    EDIT: for those asking for a guide /u/the_dogg has provided a great guide below. Be sure to up vote him:
Download Imdisk (http://www.ltr-data.se/opencode.html/)
Install it
Go in control panel there will be a new icon called IMDisk Virtual Disk Driver
Create a new disk (leave image field blank to create a ramdisk)
Give it a letter and set to use physical memory
In plex, go to server settings, Transcoder, Show advanced, set the transcoding temp dir to the ramdisk you created.
EDIT 2: This thread is to provide information to this sub. If your attitude is 'it might not work, so im never going to try it' or you are simply here to offer condescending, passive aggressive comments then please go elsewhere, don't waste our time, thank you.
EDIT 3: I made this to help people, if you have questions ask others on here. I got waves of vote brigading against my posts and reported it to mods. The mod team came on this thread and PMed me harassing and mocking me, not enforcing the rules or investigating the abuse. Attacking users who reported abuse, classy as always Reddit mods.
181 komentardeli
vsi 181 komentarji
uredi po: najboljše (suggested)
[–]pchc_lxLinux 15 točka pred 7 mesec 
I have an i5 and an SSD and have never really had more than a second or two of delay before playing any media..
stalna povezava
[–]YourPassportNumber 4 točk pred 7 mesec 
The only wait I have is for my mechanical drives to spin up when I click play. You can hear them spinning up on the server PC while you wait.
stalna povezavamatični
[–]pheoxs 7 točka pred 7 mesec 
Yeah, which would still occur even with using his ram. Plus you still have to wait for the hard drive to transfer the data to your ram so it's another bottleneck there regardless how fast the ram is.
stalna povezavamatični
[–]Fatal__Exception 3 točk pred 7 mesec 
I have an SSD which will wear out eventually. Might do this this to reduces writes to the SSD.
stalna povezavamatični
[–][deleted] -2 točka pred 7 mesec* 
Tansferring the data to the transcode directory is always there, regardless if you use my method or the default. Even if the transcode directory was on the storage array it would still need to travel through the processor and back to the storage array. So actually, RAM would speed this process up as you are not writing your transcode session to a spinning disk but rather 6gb/s RAM
Edit: if you disagree please offer a counterpoint.
stalna povezavamatični
[–]3edc_vfr4 9 točka pred 7 mesec 
Yeah I'm struggling to find what the benefit of this is. Transcoding (when necessary) is really quick on a modern computer, and the bottleneck is the CPU anyway. . .not the storage.
stalna povezavamatični
[–]putzarino 2 točke pred 7 mesec 
Yeah, I have a 6 year old i7-860 (passmark ~5k), with normal HDD, and it takes about 1 second before media starts, and never has any issues.
stalna povezavamatični
[–]ecb29 2 točke pred 7 mesec 
Op has a ridiculous workload most people don't have, where the file size is incredibly bloated.
stalna povezavamatični
[–][deleted] 7 točka pred 7 mesec* 
I have two Xeon quad cores with two ssd in raid 0 and I had up to 10 seconds in delay. I run full gigabits network too. Now everything is literally instant.
Edit: four down votes for listing my experience and my setup? This is the most assenine sub I've been on. I'm only offering an interesting software solution I'm not sure where all this anger is rooted from.
stalna povezavamatični
[–]tearsofsadness 6 točka pred 7 mesec 
10 seconds delay for transcoding on your server? That's crazy with those specs. What's the best way to judge performance for a Plex server? Just use activity monitor or sysmon?
stalna povezavamatični
[–][deleted] -2 točka pred 7 mesec 
Either or, but in the end the specs just tell you the math. You can not be maxed on a system yet a movie clips. I have seen the best monitor to be the results themselves. 10 seconds is referring to very large HD movies. I think the delay here was caused because of the constant read/write between disks. Now it just writes to RAM that it can load balance over 4 RAM channels of 6b/s each. So now there is basically instantaneous connection to my trans code directory. Look at some of the other comments, other users have elaborated the gian in I/O access.
stalna povezavamatični
[–]tearsofsadness 1 točki pred 7 mesec 
How large we talking? Most of my files are 2GB so I imagine significantly larger then that. Thanks again for all the dialog.
stalna povezavamatični
[–]coreyja 2 točke pred 7 mesec 
Not OP but he was testing using a Hobbit copy that was 28GB I think he said, so a fair amount bigger ;-)
stalna povezavamatični
[–]tearsofsadness 1 točki pred 7 mesec 
Damn I imagine it's diminishing returns with that large of a file? My 2-4GB files seem pretty crisp.
stalna povezavamatični
[–]coreyja 2 točke pred 7 mesec 
Umm yes and no. Play a 4GB file side by side with a 20GB full bluray rip and you will 100% be able to easily tell a difference. The full bluray rip will look alot nicer and smoother. If its worth it comes down to personal preference really though. I'm a quality snob so the extra file size is totally worth it for me. It also helps that I have a QHD monitor thats 2560x1440 so its really easy to see the difference a full bluray rip makes. Obtain a nice big bluray rip of a movie sometime and just compare if you are really curious about the difference, it'll definitely look better
stalna povezavamatični
[–]pchc_lxLinux 0 točka pred 7 mesec 
720p or 1080p? most encoders out there worth their salt are turning out 7-10 GB files and larger. up to 20gb sometimes.
as long as its not YIFY you're probably fine ....
stalna povezavamatični
[–][deleted] 2 točke pred 7 mesec 
Well one, as I said was the hobbit. At 28 gb. I'll try running four large files simultaneously tonight.
stalna povezavamatični
[–]pchc_lxLinux 4 točk pred 7 mesec 
to give you more helpful feedback:
to make a real assessment we would need to know what media you are streaming, in what codec and container, to what device, and what codecs & containers that device supports. also your transcode and server settings within Plex. a lot of factors go into exactly what and how Plex transcodes.
all that being said, based on the specs you listed, it sounds like you have something set up wrong or otherwise have an uncommon configuration / usage.
read the rest of the comments, most people's experiences are pretty different from yours...
stalna povezavamatični
[–][deleted] -4 točka pred 7 mesec 
The assesment is done. I ran a file a week ago and it took longer to load and skipped, now it doesn't. We are not finalizing a deliverable to the defence department, we are trying to hack together a solution to possibly increase speeds. Honestly, you're getting into the performance analytics which 90% of these users will not care about. They just care does it work or not. In my case it did, that is it.
And I have not seen these responses you seem to be referring to. I only see the comment about the drive filling.
As for incorrect set up. Its plex installed on windows with a NAS, not much to look into there, unless of course you are just looking for problems.
stalna povezavamatični
[–]Pinesol_Shots 4 točk pred 7 mesec 
So your offering performance tuning advice while saying that only anecdotal evidence is necessary because 90% of people don't care about performance tuning?
Performance is the whole point. If you don't have science to back up your idea, then it isn't worth shit.
stalna povezavamatični
[+][deleted] ocena komentarja pod mejo * (5 otrok)
[–]pchc_lxLinux 4 točk pred 7 mesec 
ಠ_ಠ
stalna povezavamatični
[–]putzarino 0 točka pred 7 mesec 
assenine
Nice try, though.
stalna povezavamatični
[–][deleted] 3 točk pred 7 mesec 
haha, surprised autocorrect didn't catch that.
stalna povezavamatični
[–]penance_spark 1 točki pred 7 mesec 
Is all of your media on the ssd or just the os?
stalna povezavamatični
[–]pchc_lxLinux 1 točki pred 7 mesec 
OS on SDD, media on 7200rpm 3tb HDD
stalna povezavamatični
[–]majesticjg 30 točka pred 7 mesec 
I'm frustrated that you're getting downvoted. Here's why this works:
Each segment has to go through the following processes:
Read this block from source file.
Transcode the block
Write the transcoded block to disk
Read and Stream the transcoded blocks from disk
That's a lot of hard disk chatter. Yes, the CPU is the biggest bottleneck, but if you can take the repeated disk access off the disk subsystem (by running 3 and 4 in RAM) you can get a speed boost anyway because you've cut down the number of times you go to the disk per block.
Technically, it makes sense, if you have the RAM. Good post.
stalna povezava
[–]bobloadmire 6 točka pred 7 mesec 
i run storage pools for our data system which as abysmal read/write latency and I started using this method a few days ago which substantially increase time to start and seek performance.
stalna povezavamatični
[–]G3TG0T 5 točka pred 7 mesec 
So based off this reasoning, would a 2nd HDD/SSD be just as good as RAM disk? Like assume I don't have much RAM to spare and I have my media on C:\ , and I add D:\ Would I see better results? If so, knowing that RAM is much much faster, do you think it would be a substantial speed decrease if you used a 2nd HDD/SSD instead of RAM?
stalna povezavamatični
[–]majesticjg 9 točka pred 7 mesec 
You're still shoving all the data through the PCI-E bus and disk subsystem (SATA) which the chipset and CPU still have to manage.
I think there would be some minor benefit to using a separate physical hard drive, but I don't know how much at that point. RAMDisk is obviously best, SSD second best, two separate mechanical HDDs third and a single mechanical HDD (my setup) would be the worst.
stalna povezavamatični
[–]G3TG0T 3 točk pred 7 mesec 
Thanks for sharing
stalna povezavamatični
[–]pcjonathan 5 točka pred 7 mesec* 
I'm frustrated that you're getting downvoted.
Because the claims made were done so with little sense (e.g. "HUGE Speed Boost" when the delay is a tiny amount of seconds), little actual reasoning backing it up (suddenly being able to upload more than he thinks he can upload?) and refusal to provide any further proof. Some of the comments didn't contribute to the discussion at hand.
I have no issue with the guy (as a reddit mod myself, I'm highly pissed to read that the mods harassed him, etc. That's not acceptable in any circumstances. I'm sorry he had to go through it.) and I have little issue with the concept but I have an issue with it being claimed it to be more than it is, or at least not specifying the use cases in which it'll greatly affect performance. Sadly, he deleted his account before I could finish writing my comment where I respond and expand further, but that's the summary of it.
Because when I get better performance on a cheap dual core remotely than he gets on 2 quad cores "before", where he goes from "10 seconds" to "literally instant" (something which I can rarely achieve under say...0.5-1 seconds through direct play or even local play), this is where I get highly suspicious.
As I said in my to-be comment. No one is arguing it is faster. The question that really matters is.....Is it worth it and who is it worth it for? Weighing up the performance against the effort, costs and risks involved for each potential server scenario, such as number of users, number of/what other processes, ease of setup, types/sizes of files etc. This is why I'm, personally, interested to see how much difference it makes to other people (since I can't test it myself as of yet).
I do definitely agree that Plex should automatically use RAM more where possible.
stalna povezavamatični
[–][deleted] 5 točka pred 7 mesec 
Thank you I really appreciate one person being nice. Either way I'm not trying to prove anyone wrong or anything I'm just trying to offer something interesting that seemed to help in my case. People are acting like I'm trying to make them repent lol.
stalna povezavamatični
[–]majesticjg 2 točke pred 7 mesec 
People have really REALLY drunk the SSD kool-aid. Yes, they are fast, but they don't eliminate the disk system bottlenecks around the PCI-E bus. And people aren't taking into account that the alternating reads and writes generate a disk queue even on the fastest SSD.
Frankly, I'm surprised Plex doesn't have an option of using more RAM and overflowing to disk instead of going all to disk.
stalna povezavamatični
[–]antiproton 0 točka pred 7 mesec 
People have really REALLY drunk the SSD kool-aid. Yes, they are fast, but they don't eliminate the disk system bottlenecks around the PCI-E bus.
I don't have any SSDs in my Plex setup. Disk IO is not a limiting factor except on initial media load, which is a trivial part of the entire process. This isn't a complex issue to understand.
stalna povezavamatični
[–]majesticjg 2 točke pred 7 mesec 
Go to /r/htpc and watch people crow about how important it is to have an SSD in your HTPC rig. If you ask them why, they'll tell you how fast it boots and how much "zippier" it'll feel. In reality, you're not rebooting this system often and you don't change applications often enough to take advantage of all that "zippy."
I love SSDs, but they aren't right for every application, always, like some people preach.
stalna povezavamatični
[–]wenestvedt 2 točke pred 7 mesec 
They are likely mostly home users, and not folks running big systems. * shrug *
stalna povezavamatični
[–]flyscan 1 točki pred 7 mesec 
Wow, the amount of down voting here is disgusting.
I was first introduced to RAM disks when DayZ was popular and ARMA 2 ran like ass. As you point out, it's all situational and there are times when the RAM disk beats an SSD. Sure, initial load time is much longer with a RAM disk, but once loaded, access is lightning fast.
It's all about making the best use of the tools you've currently got before racing out and buying the next shiny toy. Maybe the SSD users are just feeling a twang of buyers remorse being told that they didn't need to buy the 64 gb of RAM and the SSD.
stalna povezavamatični
[–][deleted] 0 točka pred 7 mesec 
I was that way until a week ago and I tried this, I though SSD was almost as fast as RAM, how foolish of me.
I love that idea, I have been looking into disk quotas to see if I can do this manually since people brought up the overflow issues but so far I have run into nothing of the sort. If you try this let me know how it works out, I would love more feedback.
stalna povezavamatični
[–]majesticjg 2 točke pred 7 mesec 
I wonder if you could create a RAMDisk and team it with a slower storage method in a Windows 8 Storage Space...
stalna povezavamatični
[–][deleted] 2 točke pred 7 mesec 
You can. Tiered storage, just reference the VHD.
stalna povezavamatični
[–]majesticjg 2 točke pred 7 mesec 
Think you'd still get the performance boost?
stalna povezavamatični
[–][deleted] 2 točke pred 7 mesec 
Yes but not nearly as good. Storage spaces will intelligently decide what goes on the fast tier based on access frequency. So for transcoding and plex it doesnt work because how often do you access the same media in high frequency? So storage spaces wouldnt know what to do, in this case we are hard assigning the RAM disk as the trasncode directory.
stalna povezavamatični
[–]majesticjg 2 točke pred 7 mesec 
Yeah, probably best to handle it manually.
stalna povezavamatični
[+][izbrisano] pred 7 mesec (1 otroka)
[–]thezlog 4 točk pred 7 mesec 
The real question:
Were you already using an SSD, or did you switch to your RAMDisk from an HDD/slow drive?
stalna povezava
[–][deleted] 5 točka pred 7 mesec* 
RAM has much higher speeds than any consumer solid state. For instance my 533mhz RAM still rates at 6gb/s and that stuff is ancient. I have a solid state I was using before but I have noticed significant increase. I also tried two 10k das drives on raid 0 and this StI'll beats it. It honestly feels otherworldly.
Edit: not sure of the down votes? My numbers are factual and accurate and I'm only trying to help this sub. Abundance of knowledge is always better than lack thereof.
stalna povezavamatični
[–][deleted] 6 točka pred 7 mesec 
RAM has much higher speeds than any consumer solid state. For instance my 533mhz RAM still rates at 6gb/s and that stuff is ancient.
Your CPU can't transcode at 6GB/s. You're lucky if it can transcode 10MB/s in real-time.
stalna povezavamatični
[+][deleted] ocena komentarja pod mejo  (9 otrok)
[–]thezlog 8 točka pred 7 mesec 
I understand all of that, I just wanted context for your "huge speed increase" :)
I'll give it a try, can't hurt anything!
stalna povezavamatični
[–]tearsofsadness 1 točki pred 7 mesec 
Is it possible to have Plex transcode to my SSD which the OS is on versus the platter drive the data is on? This got me thinking about improving performance this way.
stalna povezavamatični
[–][deleted] 0 točka pred 7 mesec 
Yes of course, in the plex trans code settings it allows you to set the temp directory. The problem with SSD vs the RAM idea I have presented is hardware life. SSD has a limited number of read/writes. RAM is fairly robust and is made to handle this constant access.
stalna povezavamatični
[–]tearsofsadness 1 točki pred 7 mesec 
Hmm so other posts have mentioned putting it to the SSD isn't going to help as the CPU will be the bottle neck.
I feel not reading and writing to the platter disk would be beneficial. Read from platter and write to SSD for transcoding.
stalna povezavamatični
[–][deleted] 0 točka pred 7 mesec 
Yes but you're thinking too macro. Think of pci bus vs RAM channels. Then think about the fact that after you write to sad you again have to transfer it, meaning another io hop.
stalna povezavamatični
[–]majesticjg -1 točka pred 7 mesec 
There is overhead going to the PCI-E bus versus going to the RAM bus, too. Comparing SSDs to RAM is so "apples to oranges" you can't explain it because they do not connect to the CPU through the same channels.
stalna povezavamatični
[–]thezlog 2 točke pred 7 mesec 
I'm not comparing SSD to RAM in my question. Read it again.
If OP had gone from a slow HDD to his RAMDisk, he would have absolutely seen a huge speed boost, however one would also a huge speed boost if they upgraded from a HDD to an SSD. Hence my question.
The question that I asked was 'Was OP previously using an SSD or a HDD'.
Based on his reply, I have additional context with which I can decide whether or not I am interested in trying it out on my system. He has since replied indicating that he was already using an SSD, and still detected a noticeable improvement in performance.
stalna povezavamatični
[–][deleted] 1 točki pred 7 mesec 
He has since replied indicating that he was already using an SSD, and still detected a noticeable improvement in performance.
He also said he's using a "NAS" so I suspect his "transcode" directory lives on his NAS device and is probably running over his storage network and not from a local drive in his PC. That would absolutely explain the results he is seeing.
All that means is he borked his install of Plex, as Plex wouldn't default to a temp drive located on a network device unless it was specifically configured to.
FWIW, I transcode lots of video and putting your video on an SSD drive is only marginally better - and that's because it reduces access latency. I've used a RAM Drive for this before and it makes zero difference.
stalna povezavamatični
[–]thezlog 2 točke pred 7 mesec 
Did we ask him? He could be storing data on a nas and transcoding it locally on his windows box. Without asking questions we can only make assumptions.
stalna povezavamatični
[–][deleted] 1 točki pred 7 mesec 
Not a Nas I use stablebit drivepool for external usb3 drives.
stalna povezavamatični
[–]antiproton 18 točka pred 7 mesec 
The bottleneck for transcoding is generally CPU availability. I don't see how this would give you any real performance gains. It's not as if your media is being read bit for bit off the hard drive and then played immediately on your client. The clients all have to buffer ahead anyway to account for network latency and so forth.
stalna povezava
[–][deleted] 3 točk pred 7 mesec 
I agree but try it. Look at my comments. I myself say cpu and bandwidth are basically it. But it helped in practice. We can theorize all day but might as well give it a try :) you lose nothing as the worst outcome is it goes just as fast.
stalna povezavamatični
[+]antiproton ocena komentarja pod mejo  (10 otrok)
[–]speshnz 2 točke pred 7 mesec 
Depends, if you're bottlenecking your CPU in "IO wait" then doing this might help
stalna povezavamatični
[–]rws 4 točk pred 7 mesec 
This only seems to make sense if the media is being played back faster than the storage device can read it. A movie will take an hour and a half to play even if you can transcode it in 5 seconds.
A 1080p movie will play back at what, 10 megabits/sec, tops? Even a cheap hard drive can read/write at >100 megabytes/sec.
Maybe this is a limitation on Windows? On Linux, I hit play and the video starts playing almost instantly on any device I use.
On my system, /tmp (default transcode location) is a 16GB memory filesystem. However, I run plex in a LXC container and I specifically did not create a memory /tmp for the container to avoid wasting the memory on transcodes. Why stick a few hundred MB to a few GB in memory when it will only be read once? That memory would be better served caching the thousands of tiny bits of Plex metadata (which every client will read). And that caching will happen automagically as it is read.
stalna povezava
[–][deleted] -3 točka pred 7 mesec 
I have more than enough ram. I've been running plex for two years now I never capped over 6gb usage with 5 concurrent transcodes. That's why I tried this, and it worked. I've said tons of times, mathematicallly it's impossible for this to help but it Did. Try it out. Nothing to lose.
stalna povezavamatični
[–]rws 2 točke pred 7 mesec 
Well, I can't try this since the tool is a Windows-only util and from what you describe is basically a Linux default. I guess I don't understand how it gets "much better" than loading in less than a second, though. What problem were you having that this helped? How did you quantify the improvement?
Even if you only have 6GB of memory actively used, the rest is all being used as a file system cache. This seems to be taking from one memory cache to create another private cache.
stalna povezavamatični
[–]coreyja 2 točke pred 7 mesec 
The util might be Windows only but someone else commented with how to create a ram disk on Linux, http://www.jamescoyle.net/how-to/943-create-a-ram-disk-in-linux. If everything for you is loading in less than a second then you probably don't need this but OP said it helped his speeds.
This is taking memory from the general Linux memory cache, but what we are creating isn't really a cache. Instead of writing the transcode to disk, then possibly caching it to the ram is the OS decides to, it is written directly to RAM. Now retrieving it is a fast as reading from a cache, but we don't have the intermediary, saving to memory then loading to the cache step. A cache works by putting files in RAM so when they are accessed multiple times it is fast. We are kinda doing the same thing, but we know the transcode will be requested soon. So instead of waiting for the disk IO operation to put the transcode in the cache, we directly put the transcode in the RAM so even the first retrieval benefits from the RAM speeds.
stalna povezavamatični
[–]rws 1 točki pred 7 mesec 
I know what it is, and like I said, I specifically chose not to create a ram disk for Plex's temp directory despite doing it for the rest of the system. It just seems like a waste.
The disk IO is far from the slowest path in a path that includes CPU transcoding and network streaming. I am mostly curious as to why that would be needed, especially when we are talking about just a handful of concurrent streams.
stalna povezavamatični
[–]coreyja 2 točke pred 7 mesec 
Ahh sorry misunderstood your first post and didn't realize you are running the rest of the filesystem from a ramdisk.
Obviously we are all kinda just guessing at performance cause it's really hard to quantify the speed ups people are talking about. In my case I don't think I've noticed much of a speedup since I did it earlier today. I'm going to leave it on most likely cause I have extra RAM and feel like moving the IO off my SSD could increase its lifespan though.
stalna povezavamatični
[–][deleted] 0 točka pred 7 mesec 
It sounds and looks like you just want to be argumentative. If you need help please let me know, obviously if you don't have Windows that is your problem, not mine. Have a nice day.
stalna povezavamatični
[–]rws 1 točki pred 7 mesec 
No, I am not trying to argue. I really DO want to know what the difference was. You agree it doesn't make sense that it helps, but you never said HOW it helped.
Are load times shorter now? What were they before? Were your videos skipping before and now they are not? Are you able to push a higher bitrate reliably?
As stated, it looks like a common kind of message you might see in a Honda ricer forum, "I tweaked the VTEC timing in my Odyssey with this kit I got on eBay, and now it runs much better!" What do you mean? Better fuel efficiency? More torque? Smoother acceleration? Usually what they mean is that it sounds like a big ass lawnmower now and that makes it more fun for them to drive.
stalna povezavamatični
[–][deleted] 1 točki pred 7 mesec 
I responded to that a few times in this thread perhaps I just did not reply to yours. Yes I have noticed a difference, that is the only reason I brought it here. My load times are near instant now and before I used to stutter watching super HD like the hobbit remotely, now no problem at all and it loads in under 5 secconds.
Another user pointed out how this may work in helping also look at majesticjg's comments.
stalna povezavamatični
[–]rws 1 točki pred 7 mesec 
Thanks. I was mostly curious and do not want people who are not having this problem to blindly replicate this. Taking away that memory comes with a cost.
If your storage system is too slow to keep up with the reads and writes related to transcoding, this could definitely help. However, if you have >8GB of memory free and a CPU fast enough to transcode multiple blu-ray rips at once, one would assume you have fast storage as well.
Professionally, I am a system administrator, and one thing that can be a problem is over or premature optimization or applying this type of change without understanding the consequence or reasoning behind it. That 8GB of "free" memory is not "unused," it is just "available." The system is actively using it behind the scenes, often to specifically speed up slow disk operations.
When sharing optimization tips like this, it is important to make clear the problem you are trying to solve and the system specifications would also help. Adding an 8GB ram disk might help you, but for the majority of people, it might totally kill system performance. It might not kill them now, but it might later as the library grows, and they wont know that this is the reason.
Anyone considering this, don't bother unless you have a problem. If you have a problem with videos skipping/loading slow then look at the system resources while it is happening. If your hard disk(s) are 100% utilized and you have gigs and gigs of free memory, this might be an appropriate solution for you. If this does not describe your situation this would either be at best a waste of time or at worst a source of many problems down the road.
stalna povezavamatični
[–][deleted] 0 točka pred 7 mesec 
I am a sys admin as well and I understand available memory is not used memory. However, the system would allocate that memory to support applications, such as plex. So instead of the system dynamically allocating I have created a static allocation. It is untrue the conditions you are stating, regardless if the disk is at 100% utilization this WILL show improvement due to the lack of IO overheadd. It is literally impossible not to help.
stalna povezavamatični
[–]rws 1 točki pred 7 mesec 
It is literally impossible not to help.
This is the only part I disagree with and the reason I was asking and wish your post came with a disclaimer. Perhaps it is a pet peeve of mine. To go back to my car analogy, not everybody needs to put a spoiler on their car, summer tires come with new (potentially dangerous) risks, and pouring an octane booster in most tanks does nothing but burn money. It is a balancing act and certain things need to be understood by the reader before they go tweaking it that is not broken.
For most people, their Plex system will be network, CPU, or frame-rate bound, and definitely not disk IO bound. Having people apply this without understanding the reasoning for doing it and the potential consequences could lead to problems much later on that become more difficult to pinpoint. Considering that memory exhaustion is probably the single quickest way to kill a system performance, it is important to consider this.
For example, on my system, streaming a transcoded 15GB blue-ray rip puts an unnoticeable load on the disk array. But, dedicating up to 25% of my system's memory to hold these temporary files would make everything else on the system perform noticeably worse. However, my setup and use case is very different from yours. I do not disagree at all that it might help you.
All I want to see is that some kind of background, justification, and perhaps some numbers back it up are given when performance tuning "tweaks" are given, especially when it involves memory.
stalna povezavamatični
[–][deleted] 1 točki pred 7 mesec 
I appreciate your feedback; however, this is hardly the place or audience to begin deep analysis of metrics. This is a simple thread, hey I found something cool, here it is if you'd like it. There are both pros and cons but none of these are very objective as every single con has also been shown to have a pro. Maybe systems won't benefit performance wise but the life point is irrefutable, we both know RAM is much more viable for constant access.
stalna povezavamatični
[–]The_DoggPlexpass 5 točka pred 7 mesec 
Do you have a tutorial for this, or at least a link to the thread you are mentioning?
stalna povezava
[–]RandomNinjaAtk 2 točke pred 7 mesec 
Me too, I would be interested in this...
stalna povezavamatični
[–]The_DoggPlexpass 3 točk pred 7 mesec 
I actually went ahead and did it, its fairly simple:
Download Imdisk (http://www.ltr-data.se/opencode.html/)
Install it
Go in control panel there will be a new icon called IMDisk Virtual Disk Driver
Create a new disk (leave image field blank to create a ramdisk)
Give it a letter and set to use physical memory
In plex, go to server settings, Transcoder, Show advanced, set the transcoding temp dir to the ramdisk you created.
stalna povezavamatični
[–]malred 2 točke pred 7 mesec 
Cmdline version:
Download and install imdisk - http://www.ltr-data.se/opencode.html/#ImDisk
Open command prompt (as administrator) and run: imdisk -a -s 2G -m X: -p "/fs:ntfs /q /y"
The above command creates a 2gb ramdisk, sets it to X: and formats it NTFS. Adjust as necessary.
Set the Transcoder temporary directory in plex: https://support.plex.tv/hc/en-us/articles/200250347-Transcoder
Good run down at link below, as well as how to create it on Windows startup.
http://forums.guru3d.com/showthread.php?t=356046
stalna povezavamatični
[–][deleted] -1 točka pred 7 mesec 
Thank you for that! My apologies for not poroviding one myself.
stalna povezavamatični
[–]pcjonathan 2 točke pred 7 mesec* 
It depends on what OS you're on. I've never tried it but I could give it a go at some point and write one up for both. For now, I guess:
Setup RamDisk (e.g. this for Windows or this for Linux.
Go to your server settings.
Show advanced
Go to transcoder
Set transcoder temporary directory to wherever the directory is (so something like X:\ for Windows, /mnt/ramdisk for linux).
Save
But like he says. Transcoding is CPU intensive rather than Disk I/O intensive so chances are, the difference would be negligible.
Edit: On second thoughts, this might be better to use instead of old/outdated SSDs that either a)Don't have decent lifespan or b)are towards the end of life, depending on how much you watch and how big the transcodes are. This is because doing this will probably dramatically lower relatively pointless writes to the SSD, the main cause of SSD deaths. (Though this is less so with newer ones).
stalna povezavamatični
[–]lordkuri 2 točke pred 7 mesec 
On most linux distributions, you can just point the transcoder's temp directory to /dev/shm
No other software required.
stalna povezavamatični
[–]pcjonathan 1 točki pred 7 mesec 
Ohhhhh. So THAT'S where it went. I knew there was a place where linux provided a ramdisk automatically but it had disappeared. Thanks!
stalna povezavamatični
[–]t3chtony 1 točki pred 7 mesec 
Actually, on more than a couple recent popular Linux distros, /tmp is already mounted on /dev/shm... Meaning, tmp is a ramdisk by default.
ArchLinux comes to mind. It's what I use for my workstation/plex server. Been running transcoding in /tmp for a while. (My main drive is also an SSD, but every little bit helps)
stalna povezavamatični
[–]irotsomaLinux 1 točki pred 7 mesec 
Here's a link to the wikipedia article with a list of RAM drive software. And here's a link to the transcoder settings help page for Plex. Basically, create a ram drive with the software and select that drive as your transcoder temp directory.
Edit: oh and here's an article on setting up a ramdisk if you happen to choose to use imdisk.
stalna povezavamatični
[–]The_DoggPlexpass 3 točk pred 7 mesec 
I just read about it in the plex forums, and the issue I can see with that is that if you have multiple transcoding at the same time, you will end up filling up your ramdisk and the playback will stop.
So it might be faster a bit but can cause other problems.
Here is a reply from the forum thread:
it is up to you to ensure that you any transcode location has enough space, if you are needed a ram disk to cater for the throughput of your files then your HDD/system has some serious speed performance issues.
stalna povezava
[–][deleted] 3 točk pred 7 mesec 
I've heard about this issue but last night I was streaming 4 videos at 1080 and it only used 2gb. Remember you don't store the whole transcode session, only segments as specified under your transcode settings.
stalna povezavamatični
[–]The_DoggPlexpass 1 točki pred 7 mesec 
Remember you don't store the whole transcode session, only segments as specified under your transcode settings.
I wasn't sure about that, thanks for the info.
What setting do you use for the segment? I set mine to 120 secs
stalna povezavamatični
[–]bobloadmire 1 točki pred 7 mesec 
I have had 6 people streaming 1080p with a 6GB ramdisk provisioned and no problems yet. YMMV
stalna povezavamatični
[–]coreyja 1 točki pred 7 mesec 
What OS are you running? Just curious cause on Linux I think the RamDisk will automatically overflow into Swap which could be masking this. I tried on Windows and my RamDisk filled up and Plex errored out.
stalna povezavamatični
[–]anekdotosPlexPass | Linux 2 točke pred 7 mesec 
On linux tmpfs will overflow into swap, ramfs on the other hand wont.
stalna povezavamatični
[–]bobloadmire 1 točki pred 7 mesec 
Windows 8.1 Pro
stalna povezavamatični
[–]PigSlamMac/iOS/Windows/Linux/Web/Metro, Plex Pass 3 točk pred 7 mesec 
Man, everyone seems really eager to cling to the "it may not help, so let's not bother trying" line of thought here, and then pretend that the pirated videos they're watching on their iPhones are sacred media they can never stand to lose. It seems like a clever approach OP. I would guess that you with dual xeons would stand to see more of an improvement than someone with an i3 or something, but since just about nobody in this thread actually knows how the transcoding code is written, we really don't know how often the drive writes become the bottleneck. It may be worth a try for me on my 6 core AMD 1100T based system.
stalna povezava
[–][deleted] 0 točka pred 7 mesec 
I really don't understand where all these self-professed sys admin experts are coming from. It's knowledge, what's the point in telling me something that something doesn't work when it works fine for me. We can play theoretical all day but that literally does nothing. I think these people are bored.
stalna povezavamatični
[+][izbrisano] pred 7 mesec (1 otroka)
[–]MirabisDebian (31TB, 5x SSD, 2x E5-2630v3) 2 točke pred 7 mesec 
This would work if someone could make a plug-in that removes the temporary files after 5-6 use. Plex itself keeps them till the end of the movie/show and quickly fills up ur ram disk.
If it cleaned up, multiple users could stream and get transcode without it filling up and booting everyone out >.<
stalna povezava
[–][deleted] -1 točka pred 7 mesec 
I wonder what size thE people reporting the issue are using. Like I said I had multiple streams.s and I was no where near being full. I think it would take about ten simultaneous streams to cause me any problems. Then again. I doubt many of them had 8gb of excess RAM lol
stalna povezavamatični
[–]The_DoggPlexpass 2 točke pred 7 mesec 
From what I have just experienced, it will create chunks of whatever length you configured. The problem is it doesn't cleanup the files as they are used.
So lets say you have a 15GB bluray rip, you just add subs (which can require transcoding) but don't decrease the quality, the resulting (whole) file would be roughly the same size. You set your length to 120secs, it will create chunks of 120 secs (for the entire movie) but the chunks that have been used already remains there until the movie is stopped. After a while your ramdisk will be full (before reaching the en of the movie if it's set to 8gb).
I have set mine to 8gb and will be trying it out tonight.
stalna povezavamatični
[–]coreyja 3 točk pred 7 mesec* 
I have a RamDisk set to only 2 gigs and am playing Up (17.07 GB). I have it playing in Plex Web and subtitles are turned on to force transcoding. Now Playing shows it's transcoding and the RamDisk is being used. Currently 5 min into the movie and 330 MB is used of the RamDisk. Will update as movie continues.
Edit 1: 15 minutes into Up. ~1 Gig used, ~1 gig free. All the transcode chunks are still present. Hopefully as we go over 50% it will start cleaning up after itself.
Edit 2: 24 minutes in. Only 430 MB left. All chunks still present
Edit 3: 28 minutes in. Under 170 MB left. Drive appears red in windows due to low free space. All chunks still present
Edit 4: And 0 bytes left! Movie played for about 5 more minutes (I have buffer throttle set at 300 secs) then stopped and eventually went to a "There is a problem playing this item error." So it seems that Plex DOES NOT cleanup the chunk files on it's own even if the disk is running out of space.
Edit 5: Stopped the video on the client and Plex deleted all the chunks. Seems like it only cleans up after playback is stopped.
Edit 6: Started the transode back up and waited for it to get about 15 min in then deleted the first 20 chunks that Plex transcoded without a problem and the stream kept playing fine. So it seems all we need is a script that cleans up the old chunks as Plex transcodes. I might work on something for this later tonight and report back here.
stalna povezavamatični
[–]jftugaWindows 1 točki pred 7 mesec 
What was the final outcome?
stalna povezavamatični
[–]coreyja 2 točke pred 7 mesec 
I think I updated after you posted. Movie played for a few minutes till it ran out of transcoded video. Then sat on the same frame for a few minutes till it gave me the error message.
stalna povezavamatični
[–][deleted] -1 točka pred 7 mesec 
I understand what you're saying but this is all theorhetical. You make some very good points but I have done this in practice and seen it to not actually be the case. Perhaps pled has been updated to keep a ratio clear? Either way yes try it out. I tried it for a week before reccomending it to you guys but I would love to know of any problems
stalna povezavamatični
[–]coreyja 1 točki pred 7 mesec 
See my comment below. I tried with a 2GB RamDisk and filled it up and Plex never deleted any of the old chunks.
stalna povezavamatični
[–][deleted] -2 točka pred 7 mesec 
Very interesting. I am wondering why my 28 gb copy of the hobbit didnt do this?
stalna povezavamatični
[–]coreyja 1 točki pred 7 mesec 
What client were you using? Are you sure it was actually transcoding? That's my only guess as to why it was working for you but didn't for me. Look in the temp dir when the Hobbit is playing and see if it's making chunks for you and see if the chunk-0000 is still there later into the movie.
stalna povezavamatični
[–][deleted] -2 točka pred 7 mesec 
I will try this more in depth tonight and see if I can tell. Yes it was trans coding I made sure and I only saw 2gb total space taken with 4 streams one of which was the hobbit. Ill try to gather more metrics tonight.
stalna povezavamatični
[–]coreyja 1 točki pred 7 mesec 
Hmm that is strange. Definitely investigate more tonight. I used the Web client, set the quality to 20mb and turned on subtitles, just for comparison.
stalna povezavamatični
[–][deleted] -1 točka pred 7 mesec 
okay ill use the same settings. I was using multiple devices as well (Phone tablet etc) but I will try this out tonight.
stalna povezavamatični
[–]pcjonathan 2 točke pred 7 mesec 
Since transcoding is a CPU-intensive task, I don't see much, if any, improvement happening over shaving a second or so off a transcoded video starting, unless the disk used is incredibly low quality. Of course, RAM is far far faster but you're constantly quoting theoretical numbers for a small part of the system. The only difference that matters for this is practically and this changes little. This is for those people who really can't wait that second or two and must do anything to shave it off.
IMHO, I wouldn't recommend doing this unless you have plenty of free RAM setup that you don't mind losing and/or have plenty of clients streaming high quality programs with a shitty HDD setup and/or you do other things that has some serious I/O operations (I think a popular minecraft server or two would count as that?).
Could someone other than OP who has tried this comment on what the effect has been? This sounds like a huge placebo effect/other factors involved.
stalna povezava
[+][izbrisano] pred 7 mesec (2 otrok)
[–][deleted] -2 točka pred 7 mesec 
I welcome all critisizm. I'm not mentioning anything theorhetical. All my experiences have been in practice not in theory. Please try it yourself as well. It is only practical for me since I have a dedicated ple. Server with 16gb RAM and we both know plex Will never touch anything over 6. I also did it to save life. I figure RAM is much more capable of constant access without degredation, but that is a theory.
stalna povezavamatični
[–]jeremyal 1 točki pred 7 mesec 
Would this be any quicker than the plex transcoding directory being on a SSD?
stalna povezava
[–]majesticjg 1 točki pred 7 mesec 
There is overhead going to the PCI-E bus versus going to the RAM bus, too. Comparing SSDs to RAM is so "apples to oranges" you can't explain it because they do not connect to the CPU through the same channels.
stalna povezavamatični
[+][deleted] ocena komentarja pod mejo  (1 otroka)
[–]fryfrog 1 točki pred 7 mesec 
I bet doing this on an SSD would be a nice middle ground between RAM and HDD.
stalna povezava
[–]majesticjg 1 točki pred 7 mesec 
There is overhead going to the PCI-E bus versus going to the RAM bus, too. Comparing SSDs to RAM is so "apples to oranges" you can't explain it because they do not connect to the CPU through the same channels.
stalna povezavamatični
[–]fryfrog 1 točki pred 7 mesec 
What? I'm not comparing SSD to RAM, I'm just saying if your Plex install is on a spinning disk, an SSD would be a nice improvement.
stalna povezavamatični
[–][deleted] 1 točki pred 7 mesec 
It is but RAM is so much faster. I've tried many combinations before this.
stalna povezavamatični
[–]fryfrog 1 točki pred 7 mesec 
RAM is without doubt much faster :)
stalna povezavamatični
[–]Bad_Grammer_Girl 1 točki pred 7 mesec 
RAM is definitely a lot faster, but is it worth the extra effort or are we talking "diminishing returns" here? I'm genuinely curious about that. I mean, if it works fine and is pretty fast on SSD's, would there be any noticeable and actual benefit to swapping it over to a RAM drive?
stalna povezavamatični
[–][deleted] -1 točka pred 7 mesec 
I noticed a benefit. Try it and see, I noticed just by how quick things loaded. I know what you're saying. Bottlenecks right? But I have stablebit drivepool as my storage with duplication enabled. So I have io boost over usb3. So instead of all that traffic trying to bustle into an ssd it can now be loaded across four channels. The logic worked for me so I tried it in practice and movies are almost instant now. I have 5mbs upload but somehow I'm streaming 3 1080 streams simultaneous on wan no problem. It's literally mathematically impossible But somehow it's working now.
stalna povezavamatični
[–]Bad_Grammer_Girl 1 točki pred 7 mesec 
LoL, maybe I'll give it a try. Thanks for the info :-)
stalna povezavamatični
[–][deleted] -1 točka pred 7 mesec* 
You bet, nice name btw :) let me know if you need help!
Also think of this. RAM is designed for constant read write. HDD not so much, so my hope is that the RAM will not degrade as fast as an HDD this is a theory of course but I hope it's right lol. Look up cell poweredge 2950 on Craig's list. I get them for $250 each they have raid car, dual gigabits, dual Xeon quads and 16gb RAM. Not bad for $250 lol.
stalna povezavamatični
[–]bobloadmire 1 točki pred 7 mesec* 
I discovered this a few days ago, and it made a difference in seek times.
i run storage pools for our data system which as abysmal read/write latency and I started using this method a few days ago which substantially increase time to start and seek performance.
stalna povezava
[–][deleted] 0 točka pred 7 mesec 
I did it for fun just to see how well it worked, wow, I am totally surprised.
stalna povezavamatični
[–]bobloadmire 1 točki pred 7 mesec 
in your usage i'm not sure how much of a difference you would notice though. Our case, Storage Pool Performance is so piss poor and it made a huge difference.
stalna povezavamatični
[–][deleted] 0 točka pred 7 mesec 
It made quite the difference, less disk io overhead by a huge amount really is noteicable. Like I said, reduced seek times, less hickups and hopefully RAM is better at taking the constant access requests than traditional HDD.
stalna povezavamatični
[–]taytortotWindows 10 10TB | Roku 3 | Chromecast 1 točki pred 7 mesec* 
Just a word of warning to those transcoding using an SSD:
SSDs have a limited number of writes. If you're constantly transcoding, your SSD is going to have a significantly shorter life. This is why I set my transcode directory to my HDD.
stalna povezava
[–]ecb29 1 točki pred 7 mesec 
The lifetime of good SSDs is pretty ridiculous though. I doubt you would impact it with transcoding.
stalna povezavamatični
[–][deleted] 1 točki pred 7 mesec 
Great point, and I've mentioned that as a reason as well, RAM is much more durable for these operations.
stalna povezavamatični
[–]taytortotWindows 10 10TB | Roku 3 | Chromecast 1 točki pred 7 mesec 
And thank you for posting this. I've saved this post. As soon as I get home from work, I'll be setting this up.
stalna povezavamatični
[–][deleted] 1 točki pred 7 mesec 
Let me know how it works. Even if I help one person im happy :)
stalna povezavamatični
[–]jftugaWindows 1 točki pred 7 mesec 
Since most consumer SSD's have a limited write life, this may be better than transcoding to SSD for the simple reason of extending the life of the SSD. Thoughts?
stalna povezava
[–][deleted] 1 točki pred 7 mesec 
I agree, one of the main reasons I use this now.
stalna povezavamatični
[–]anekdotosPlexPass | Linux 1 točki pred 7 mesec* 
Linux (This will overflow into swap if you hit your RAM limit):
sudo mount -t tmpfs -o size=512m tmpfs /mnt/ramdisk
stalna povezava
[–]McFeely_Smackup 1 točki pred 7 mesec 
This isnt' a slam dunk, it could in fact be a huge performance detriment if you're RAMdisking system memory Plex needs to be using. that'll cause excessive paging, and suckage will ensue.
that being said, if someone were running 16GB like OP (and myself) on a dedicated Plex sever, you definitely have the RAM to spare.
I'm curious though how Plex handles the transcode temp dir capacity. i.e. what happens with transcoding a 25GB file through an 8GB VHD?
stalna povezava
[–]coreyja 1 točki pred 7 mesec 
Here is my account of trying it, Here.
Mine filled up then errored out. If you are on Linux the RamDisk can automatically overflow to Swap so I think this will be a Windows only problem.
stalna povezavamatični
[–][deleted] 1 točki pred 7 mesec 
As for your curiosity, try it out. I was transcoding 1080 copy of the hobbit (28gb) last night no hickup (yes I ran it all the way through)
stalna povezavamatični
[–]McFeely_Smackup 1 točki pred 7 mesec 
I intend to try it out tonight.
stalna povezavamatični
[+][izbrisano] pred 7 mesec (4 otroci)
[–]Auriok 1 točki pred 7 mesec 
Thanks for the info, going to try it out and run some tests.
stalna povezava
[–][deleted] 1 točki pred 7 mesec 
No worries, good luck let me know if you need any help.
stalna povezavamatični
[–]Skiffbug 1 točki pred 7 mesec 
Thanks, seems worth a try. Keep up the good work.
stalna povezava
[–][deleted] 1 točki pred 7 mesec 
Thank you I hope it helps :) Let me know if you have any questions!
stalna povezavamatični
[–]nihr43 1 točki pred 7 mesec 
on linux based machines you can just mount a folder as tmpfs. can be used as scratch space for anything youre working on
stalna povezava
[–]day-walkin-ginger 1 točki pred 7 mesec 
This is awesome, will check it out. Should boost my lower powered system some :D
stalna povezava
[–]Magnum26 1 točki pred 7 mesec 
Is there a Linux equivalent?
stalna povezava
[–]gl75 1 točki pred 7 mesec 
I can only point you down a path... I've never tested with plex.
Linux as an shm device... very basically... a mount point of memory. You might be able to achieve what you are looking for. I would check if it configured on your system and if it need resizing. Then you would to point plex to it.
My only experience with it is from the Oracle space
Link below should get your started
http://www.cyberciti.biz/tips/what-is-devshm-and-its-practical-usage.html
stalna povezavamatični
[–]pravka 1 točki pred 7 mesec 
It's insanely easy to create a ramdisk on Linux. Let's say you wanted to create an 8GB ramdisk:
mkdir /tmp/ramdisk
chmod 777 /tmp/ramdisk
mount -t tmpfs -o size=8G /tmp/ramdisk
stalna povezavamatični
[–]gl75 1 točki pred 7 mesec 
Your EDIT 2 gave me a good giggle... I posted a while back a post on how to bypass the 12mbps limit of the chromecast. I offered one way and reference a different approach by somebody. The entire post was around being geeky, yes mocking around and along the line of "could" opposed to "should"... Anyway... I got replies like "for quality you have to pay" You should not play with this as limitations are there for a reason...
Duh...
Thanks for trying things and sharing
stalna povezava
[–][deleted] 1 točki pred 7 mesec 
Wow this is great, 800mb/s read and write speed is what I'm getting from Crystalmark. Thanks for the advice, I never knew there were so many assholes around.
stalna povezava
[–]xfatkidcorex 1 točki pred 7 mesec 
thanks for sharing! Although many don't find it useful, I love finding new ways to accomplish things. While many of you may have excellent setups, this knowledge is worthwhile noting.
Thanks for the share.
stalna povezava
[–]ElectroSporeiOS/Windows/Linux/Roku 1 točki pred 7 mesec 
The ONLY thing this will possibly improve is the time between clicking play and the video starting for a trans-coded video. Even then where are your numbers..
HUGE SPEED BOOSE saies nothing!!!!!!!.
A SUPER shitty 5400 RPM drive will do 50MB/s, a good one 150MB/s an SSD will be between 200 and 500MB/s depending on the quality.
A TV episode is typically less than 500MB so A good HD will read it in seconds.
SO if we are talking about local disk on a Plex server the savings here has to be incredibly tiny..
My raid setup using big slow drives still gets 400MB/s. Disk I/O is not really the bottleneck...


***
