filename: c-default-value-for-struct-member-20260112.txt
https://stackoverflow.com/questions/13716913/default-value-for-struct-member-in-c

default value for struct member in C

   Is it possible to set default values for some struct member? I tried the following but, it'd cause
   syntax error:

typedef struct {
	int flag = 3;
} MyStruct;

   Errors:
$> gcc -o testIt test.c
test.c:7: error: expected ':', ',', ';', '}' or '__attribute__' before '=' token
test.c: In function 'main':
test.c:17: error: 'struct <anonymous>' has no member named 'flag'

***
   Structure is a data type. You don't give values to a data type. You give values to instances/objects
   of data types.

   So no this is not possible in C.

   Instead you can write a function which does the initialization for structure instance.

   Alternatively, You could do:

struct MyStruct_s {
	int id;
} MyStruct_default = {3};

typedef struct MyStruct_s MyStruct;

   And then always initialize your new instances as:

MyStruct mInstance = MyStruct_default;

***
   you can not do it in this way

typedef struct {
	int id;
	char* name;
}employee;

employee emp = {
	.id = 0,
	.name = "none"
};

   You can use macro to define and initialize your instances. this will make easiier to you each time
   you want to define new instance and initialize it.

typedef struct {
	int id;
	char* name;
}employee;

#define INIT_EMPLOYEE(X) employee X = {.id = 0, .name ="none"}

   and in your code when you need to define new instance with employee type, you just call this macro
   like:

INIT_EMPLOYEE(emp);

***
   I agree with Als that you can not initialize at time of defining the structure in C. But you can
   initialize the structure at time of creating instance shown as below.

   In C,
struct s {
	int i;
	int j;
};

struct s s_instance = { 10, 20 };

   in C++ its possible to give direct value in definition of structure shown as below

struct s {
	int i;
	s(): i(10) {}
};

***
   You can do:

struct employee_s {
	char* name;
	int id;
   } employee_default = {0, "none"};

typedef struct employee_s employee;

   And then you just have to remember to do the default initialization when you declare a new employee
   variable:

employee foo = employee_default;

***
   Create a default struct as the other answers have mentioned:

struct MyStruct {
	int flag;
}

MyStruct_default = {3};

   However, the above code will not work in a header file - you will get error: multiple definition of
   'MyStruct_default'. To solve this problem, use extern instead in the header file:

struct MyStruct {
	int flag;
};

extern const struct MyStruct MyStruct_default;

   And in the c file:
const struct MyStruct MyStruct_default = {3};

   Hope this helps anyone having trouble with the header file.

***
   You can use combination of C preprocessor functions with varargs, compound literals and
   designated initializers for maximum convenience:

typedef struct {
	int id;
	char* name;
} employee;

#define EMPLOYEE(...) ((employee) { .id = 0, .name = "none", ##__VA_ARGS__ })

employee john = EMPLOYEE(.name="John");  // no id initialization
employee jane = EMPLOYEE(.id=5);         // no name initialization

***
   If you are using gcc you can give designated initializers in object creation.

typedef struct {
	int id = 0;
	char *name = "none";
} employee;

employee e = {
	.id = 0;
	.name = "none";
};

   Or , simply use like array initialization.

   employee e = {0 , "none"};

***
   Even more so, to add on the existing answers, you may use a macro that hides a struct initializer:

#define DEFAULT_EMPLOYEE { 0, "none" }

   Then in your code:
employee john = DEFAULT_EMPLOYEE;

***
   You can implement an initialisation function:

employee init_employee() {
	empolyee const e = {0,"none"};
	return e;
}

***
   If you only use this structure for once, i.e. create a global/static variable, you can remove
   typedef, and initialized this variable instantly:

struct {
	int id;
	char *name;
} employee = {
	.id = 0,
	.name = "none"
};

   Then, you can use employee in your code after that.

***
   You can use some function to initialize struct as follows,

typedef struct {
	int flag;
} MyStruct;

MyStruct GetMyStruct(int value) {
	MyStruct My = {0};
	My.flag = value;
	return My;
}

void main (void) {
	MyStruct temp;
	temp = GetMyStruct(3);
	printf("%d\n", temp.flag);
}

   EDIT:
typedef struct {
	int flag;
} MyStruct;

MyStruct MyData[20];

MyStruct GetMyStruct(int value) {
	MyStruct My = {0};
	My.flag = value;
	return My;
}

void main (void) {
	int i;
	for (i = 0; i < 20; i ++)
		MyData[i] = GetMyStruct(3);

	for (i = 0; i < 20; i ++)
		printf("%d\n", MyData[i].flag);
}

***
   Another approach to default values. Make an initialization function with the same type as the struct.
   This approach is very useful when splitting large code into separate files.

struct structType {
	int flag;
};

struct structType InitializeMyStruct() {
	struct structType structInitialized;
	structInitialized.flag = 3;
	return(structInitialized);
};


int main() {
	struct structType MyStruct = InitializeMyStruct();
};

***
   You can create a function for it:
typedef struct {
	int id;
	char name;
} employee;

void set_iv(employee *em);

int main() {
	employee em0; set_iv(&em0);
}

void set_iv(employee *em) {
	(*em).id = 0;
	(*em).name = "none";
}


---

